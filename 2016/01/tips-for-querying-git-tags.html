<!DOCTYPE html>
<html>
    <head>
        <title>Tips for querying git tags - Cole's dev log</title>
        <meta charset="utf-8" />
        <link href="https://blog2.wikichoon.com/theme/minima-main.css" rel="stylesheet" />
        <link href="https://blog2.wikichoon.com/theme/coletheme.css" rel="stylesheet" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link href="https://blog2.wikichoon.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Cole's dev log Full Atom Feed" />
    </head>

    <body id="index" class="archive">
        <div class="wrapper">
            <header class="site-header" role="banner">
                <a class="site-title" href="https://blog2.wikichoon.com">Cole's dev log</a>
                <nav class="site-nav">
                <div class="trigger">
                    <a class="page-link" href="https://blog2.wikichoon.com">Home</a>
                    <a class="page-link" href="https://blog2.wikichoon.com/archives.html">Archives</a>
                <!-- -->
                </div></nav>
             </header>
<main id="content" class="page-content">

  <header>
    <h2 class="post-title">Tips for querying git tags</h2>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-01-20T10:00:00-05:00" itemprop="datePublished">Wed 20 January 2016
      </time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Cole Robinson</span>
      </span> • </a> Tags: <a href="https://blog2.wikichoon.com/tag/fedora.html">fedora </a><a href="https://blog2.wikichoon.com/tag/virt.html">virt </a>    </p>
  </header>

  <div class="post-content">
    <p>With package maintenance, bug triage, and email support, I often need to look at a project's git tags to know about the latest releases, when they were released, and what releases contain certain features. Here's a couple workflow tips that make my life easier.</p>
<h3>Better git tag listing</h3>
<p>Based on Peter Hutterer's <a href="http://who-t.blogspot.com/2012/06/git-branch-info.html">'git bi'</a> alias for improved branch listing (which is great and highly recommended), I made one for improved tags output that I mapped as 'git tags'. Output looks like:</p>
<p><a href="http://1.bp.blogspot.com/-S1JscfM_bNg/U8WjuPH4hYI/AAAAAAAAAEc/6oZXuvPiHh8/s1600/Screenshot+from+2014-07-15+17:56:45.png"><img alt="" height="109" src="http://1.bp.blogspot.com/-S1JscfM_bNg/U8WjuPH4hYI/AAAAAAAAAEc/6oZXuvPiHh8/s1600/Screenshot+from+2014-07-15+17:56:45.png" width="400"></a></p>
<ul>
<li>Shows tag name, commit message, commit ID, and date, all colorized. Commit message is redundant for many projects that tag the release commit, but it's interesting in some cases.</li>
<li>Tags are listed by date rather than alphabetically. Some projects change tag string formats, or versioning schemes, that then don't sort correctly when listed alphabetically. Sorting by date makes it easy to see the latest tag. Often I just want to know what the latest tag or the latest stable release is, this makes it easy.</li>
</ul>
<p>The alias code is:</p>
<div class="highlight"><pre><span></span><span class="k">[alias]</span>
   <span class="na">tags</span> <span class="o">=</span> <span class="s">&quot;!sh -c &#39; \</span>
<span class="na">git for-each-ref --format</span><span class="o">=</span><span class="s">\&quot;%(refname:short)\&quot; refs/tags | \</span>
<span class="na">while read tag; do \</span>
   <span class="na">git --no-pager log -1 --format</span><span class="o">=</span><span class="s">format:\&quot;$tag %at\&quot; $tag; echo; \</span>
<span class="na">done | \</span>
<span class="na">sort -k 2 | cut -f 1 --delimiter</span><span class="o">=</span><span class="s">\&quot; \&quot; | \</span>
<span class="na">while read tag; do \</span>
   <span class="na">fmt</span><span class="o">=</span><span class="s">\&quot;%Cred$tag:%Cblue %s %Cgreen%h%Creset (%ai)\&quot;; \</span>
<span class="s">   git --no-pager log -1 --format=format:\&quot;$fmt\&quot; $tag; echo; \</span>
<span class="na">done&#39;&quot;</span>
</pre></div>


<h3>Find the first tag that contains a commit</h3>
<p>This seems to come up quite a bit for me. An example is <a href="http://www.redhat.com/archives/libvir-list/2014-July/msg00832.html">here</a>; a user was asking about a virt-install feature, and I wanted to tell them what version it appeared in. I grepped <code>git log</code>, found the commit, then ran:</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> git describe --contains 87a611b5470d9b86bf57a71ce111fa1d41d8e2cd
<span class="go">v1.0.0~201</span>
</pre></div>


<p>That shows me that v1.0.0 was the first release with the feature they wanted, just take whatever is to the left of the tilde.</p>
<p>This often comes in handy with backporting as well: a developer will point me at a bug fix commit ID, I run git describe to see what upstream version it was released in, so I know what fedora package versions are lacking the fix.</p>
<p>Another tip here is to use the --match option to only search tags matching a particular glob. I've used this to filter out matching against a maintenance or bugfix release branch, when I only wanted to search major version releases.</p>
<h3>Don't pull tags from certain remotes</h3>
<p>For certain repos like qemu.git, I add a lot of git remotes pointing to individual developer's trees for occasional patch testing. However if trees have lots of non-upstream tags, like for use with pull-requests, they can interfere with my workflow for backporting patches. Use the --no-tags option for this: <code>git remote add --no-tags $repo</code></p>
  </div>

</main>


<footer class="site-footer h-card">
  <div class="wrapper">
    <h2 class="footer-heading">Cole's dev log</h2>
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
            <li class="p-name">Cole Robinson </li><li><a class="u-email" href="mailto:">aintdiscole@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/crobinso"><svg class="svg-icon"><use xlink:href="https://blog2.wikichoon.com/theme/minima-social-icons.svg#github"></use></svg> <span class="username">crobinso</span></a></li><li><a href="https://www.twitter.com/aintdiscole"><svg class="svg-icon"><use xlink:href="https://blog2.wikichoon.com/theme/minima-social-icons.svg#twitter"></use></svg> <span class="username">aintdiscole</span></a></li><li><a href="https://www.linkedin.com/in/cole-robinson-484a9912"><svg class="svg-icon"><use xlink:href="https://blog2.wikichoon.com/theme/minima-social-icons.svg#linkedin"></use></svg> <span class="username">Cole Robinson</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3" align="center">
        <a href="https://blog2.wikichoon.com/feeds/all.atom.xml">RSS</a>
      </div>
    </div>

  </div>
</footer>
        </div><!-- container -->
    </body>
</html>