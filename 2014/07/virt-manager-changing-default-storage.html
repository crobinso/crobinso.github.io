<!DOCTYPE html>
<html>
    <head>
        <title>virt-manager: changing the default storage path and default virtual network - Cole Robinson</title>
        <meta charset="utf-8" />
        <link href="https://crobinso.github.io/theme/minima-main.css" rel="stylesheet" />
        <link href="https://crobinso.github.io/theme/coletheme.css" rel="stylesheet" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link href="https://crobinso.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Cole Robinson Full Atom Feed" />
    </head>

    <body id="index" class="archive">
        <div class="wrapper">
            <header class="site-header" role="banner">
                <a class="site-title" href="https://crobinso.github.io">Cole Robinson</a>
                <nav class="site-nav">
                <div class="trigger">
                    <a class="page-link" href="https://crobinso.github.io">Home</a>
                    <a class="page-link" href="https://crobinso.github.io/archives.html">Archives</a>
                <!-- -->
                </div></nav>
             </header>
<main id="content" class="page-content">

  <header>
    <h2 class="post-title">virt-manager: changing the default storage path and default virtual network</h2>
    <p class="post-meta">
      <time class="dt-published" datetime="2014-07-15T15:45:00-04:00" itemprop="datePublished">Tue 15 July 2014
      </time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Cole Robinson</span>
      </span> • </a> Tags: <a href="https://crobinso.github.io/tag/fedora.html">fedora </a><a href="https://crobinso.github.io/tag/virt.html">virt </a>    </p>
  </header>

  <div class="post-content">
    <p>When creating a new virtual machine via virt-manager or virt-install, the tools make some assumptions about the default location for disk images, and the default network source.</p>
<p>For example, in the 'New VM' wizard, the storage page will offer to create a disk image in the default location:</p>
<p><a href="http://4.bp.blogspot.com/-sYFmftbe-VA/U8V_KQ11FaI/AAAAAAAAAD0/gszjhOLZbAI/s1600/Screenshot+from+2014-07-15+15:20:56.png"><img alt="" height="400" src="http://4.bp.blogspot.com/-sYFmftbe-VA/U8V_KQ11FaI/AAAAAAAAAD0/gszjhOLZbAI/s1600/Screenshot+from+2014-07-15+15:20:56.png" width="367"></a></p>
<p>The default location for most uses of virt-manager is /var/lib/libvirt/images, which is created by libvirt and has the expected selinux labelling and permission to run QEMU/KVM VMs.</p>
<p>Behind the scenes, virt-manager is using a libvirt storage pool for creating disk images. When the 'New VM' wizard is first run, virt-manager looks for a storage pool named 'default'; if it doesn't find that it will create a storage pool named 'default' pointing to /var/lib/libvirt/images. It then uses that 'default' pool for the disk provisioning page.</p>
<p>The default virtual network works similarly. The libvirt-daemon-config-network package will dynamically create a libvirt virtual network named 'default'. You can see the XML definition <a href="http://libvirt.org/git/?p=libvirt.git;a=blob;f=src/network/default.xml;h=d7241d0c16271bb7598b5bc1bb90d8145183de50;hb=HEAD">over here</a> in libvirt.git.</p>
<p>When virt-manager reaches the last page of the 'New VM' wizard, if there's a virtual network named 'default', we automatically select it as the network source:</p>
<p><a href="http://3.bp.blogspot.com/-RMEQe709QCg/U8WCpEKwFdI/AAAAAAAAAEA/qypJIW5YRwQ/s1600/Screenshot+from+2014-07-15+15:35:47.png"><img alt="" height="400" src="http://3.bp.blogspot.com/-RMEQe709QCg/U8WCpEKwFdI/AAAAAAAAAEA/qypJIW5YRwQ/s1600/Screenshot+from+2014-07-15+15:35:47.png" width="285"></a></p>
<p>It's also the network source used when no explicit network configuration is passed to virt-install.</p>
<p>Every now and then someone asks how to make virt-manager/virt-install use a different storage pool or network as the default. As the above logic describes, just name the desired virtual network or storage pool 'default', and the tools will do the right thing.</p>
<p>You can rename storage pools and virtual networks using virt-manager's UI from Edit->Connection Details. It only works on a stopped object though. Here's an example renaming a virtual network 'default' to 'new-name':</p>
<p><a href="http://2.bp.blogspot.com/-bzrj04OTliw/U8WEC1PlGDI/AAAAAAAAAEM/ABU7QO-i7Tk/s1600/Screenshot+from+2014-07-15+15:41:33.png"><img alt="" height="481" src="http://2.bp.blogspot.com/-bzrj04OTliw/U8WEC1PlGDI/AAAAAAAAAEM/ABU7QO-i7Tk/s1600/Screenshot+from+2014-07-15+15:41:33.png" width="640"></a></p>
  </div>

</main>


<footer class="site-footer h-card">
  <div class="wrapper">
    <h2 class="footer-heading">Cole's dev log</h2>
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
            <li class="p-name">Cole Robinson </li><li><a class="u-email" href="mailto:">aintdiscole@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/crobinso"><svg class="svg-icon"><use xlink:href="https://crobinso.github.io/theme/minima-social-icons.svg#github"></use></svg> <span class="username">crobinso</span></a></li><li><a href="https://www.twitter.com/aintdiscole"><svg class="svg-icon"><use xlink:href="https://crobinso.github.io/theme/minima-social-icons.svg#twitter"></use></svg> <span class="username">aintdiscole</span></a></li><li><a href="https://www.linkedin.com/in/cole-robinson-484a9912"><svg class="svg-icon"><use xlink:href="https://crobinso.github.io/theme/minima-social-icons.svg#linkedin"></use></svg> <span class="username">Cole Robinson</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3" align="center">
        <a href="https://crobinso.github.io/feeds/all.atom.xml">RSS</a>
      </div>
    </div>

  </div>
</footer>
        </div><!-- container -->
    </body>
</html>